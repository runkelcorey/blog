{
  "hash": "728b560cb4f871860bee52abdf8c30f1",
  "result": {
    "markdown": "---\ntitle: Where are Cambridge liquor licenses concentrated?\nauthor: corey\ndate: '2022-07-04'\ncategories:\n  - political economy\n  - R\n  - spatial analysis\neditor_options: \n  markdown: \n    wrap: sentence\n---\n\n\nAn article published last week by the *Boston Globe* profiled research by beverage industry consultancy OFFSITE that showed liquor licenses cluster in white neighborhoods.\nThe results, it claimed, are a result of Prohibition-era regulations around liquor licenses, which sought to restrict {insert quote here} from alcohol.\nIn creating these legal barriers to allay their fears of Irish stereotypes, the laws also made it harder for Black, Asian, and Latinx business.\nI'm curious if the same dynamic plays out in Cambridge, though I'm ignorant of the legal history here.\nAdditionally, \\[Boston\\] permits run \\$400,000 on the secondary market, so their distribution is big business.\n\nTo analyze this situation, I want to answer three questions:\n\n1.  Are \\[restaurant\\] liquor licenses more likely to appear in whiter neighborhoods?\n\n2.  How are retail liquor licenses distributed?\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in system(\"timedatectl\", intern = TRUE): running command 'timedatectl'\nhad status 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.10.2, GDAL 3.4.3, PROJ 8.2.0; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(tmap)\nlibrary(tidycensus)\n```\n:::\n\n\nThe City of Cambridge provides open data on permitees in their portal.\nWe do not see applications.\nDemographic data come from the 2020 US Census.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfood_permits <- jsonlite::read_json(\"https://data.cambridgema.gov/resource/iect-ma2e.json\", simplifyVector = T) %>%\n  filter(!is.na(longitude), !is.na(latitude)) %>%\n  mutate(number_of_seats = as.numeric(number_of_seats)) %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 'NAD83')\noutdoor_permits <- jsonlite::read_json(\"https://data.cambridgema.gov/resource/qzsr-xrig.json\", simplifyVector = T) %>%\n  filter(!is.na(longitude), !is.na(latitude)) %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"))\n```\n:::\n\n\nAt the very least, I'll need race data for Middlesex County, MA.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncambridge_race <- get_decennial(\n  geography = \"tract\",\n  state = \"MA\",\n  county = \"Middlesex\",\n  variables = c(\n    Hispanic = \"P2_002N\",\n    White = \"P2_005N\",\n    Black = \"P2_006N\",\n    Native = \"P2_007N\",\n    Asian = \"P2_008N\"\n  ),\n  summary_var = \"P2_001N\",\n  year = 2020,\n  geometry = TRUE\n) %>%\n  mutate(percent = 100 * (value / summary_value)) %>%\n  st_filter(food_permits, .predicate = st_intersects)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nGetting data from the 2020 decennial Census\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing the PL 94-171 Redistricting Data summary file\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |======================================================================| 100%\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 2020 decennial Census data use differential privacy, a technique that\nintroduces errors into data to preserve respondent confidentiality.\nℹ Small counts should be interpreted with caution.\nℹ See https://www.census.gov/library/fact-sheets/2021/protecting-the-confidentiality-of-the-2020-census-redistricting-data.html for additional guidance.\nThis message is displayed once per session.\n```\n:::\n:::\n\n\n## EDA\n\nLet's start with some simple maps---where are food permits?\nwhat are the city's boundaries?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncambridge_race %>%\n  filter(variable == 'White') %>%\n  tm_shape() +\n  tm_polygons(col = \"percent\",\n          style = \"quantile\",\n          n = 5,\n          palette = \"-Greys\",\n          title = \"2020 US Census\") + \n  tm_shape(food_permits) +\n  tm_dots(col = \"permit_type\",\n          size = \"number_of_seats\",\n          title = \"Permit Type\",\n          title.size = \"Number of Seats\") +\n  tm_layout(title = \"Percent White\\nby Census tract\\nand Restaurants\",\n            frame = FALSE,\n            legend.outside = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nPermits cluster along the city's main streets---Massachussetts Ave., Broadway, Hampshire---and at first glance whiter neighborhoods do get more alcohol permits, though total permit numbers appear well-distributed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfood_permits %>%\n  st_join(filter(cambridge_race, variable == \"White\")) %>%\n  st_drop_geometry() %>%\n  group_by(GEOID, permit_type, percent, summary_value) %>%\n  summarize(permits_per_capita = n()/summary_value) %>%\n  ggplot(aes(percent, permits_per_capita, col = permit_type)) +\n  geom_point() +\n  geom_smooth()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'GEOID', 'permit_type', 'percent',\n'summary_value'. You can override using the `.groups` argument.\n`geom_smooth()` using method = 'loess' and formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : span too small. fewer data values than degrees of freedom.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : at 47.799\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : radius 0.0012088\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : all data on boundary of neighborhood. make span bigger\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : pseudoinverse used at 47.799\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : neighborhood radius 0.034768\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : reciprocal condition number 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : There are other near singularities as well. 48.838\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric =\nparametric, : zero-width neighborhood. make span bigger\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Computation failed in `stat_smooth()`:\nNA/NaN/Inf in foreign function call (arg 5)\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThe biggest issue with this approach is a lack of data!\nWe could add control variables, but we'd just be diluting an already watery model.\nWhat other questions could we answer with these data?\n\n## Outdoor Seating and City Microclimates\n\nUrban heat has been a big topic in the last few years; Boston adds to that frigid winter temperatures.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}